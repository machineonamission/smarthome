[Build]
ImageTag=localhost/ollama_fork
SetWorkingDirectory=https://github.com/machineonamission/ollama.git
Pull=missing
# 8 cpus
PodmanArgs=--cpu-period=100000
PodmanArgs=--cpu-quota=800000
# 8g, unlimited swap
PodmanArgs=--memory=8g
PodmanArgs=--memory-swap=-1
PodmanArgs=--cache-from=ghcr.io/ollama/ollama

[Service]
# Only proceed with this build if the image is missing.
# If it exists, the shell exits with 1, which tells systemd to gracefully skip the build command.
ExecCondition=/bin/sh -c '/usr/bin/podman image exists localhost/ollama_fork && exit 1 || exit 0'
